<!DOCTYPE html>
<html lang="en">

<head>

    <title>
	  
	    Post
	  
	</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<!-- Open Graph -->

    <meta content="Business Science" property="og:site_name">
    <meta name="author" content="mattdancho.com" />

    
      <meta content="Post" property="og:title">
      <meta content="Post" property="twitter:title"/>
    

    
      <meta content="article" property="og:type">
    

    
    <meta name="description" content="Applying data science to business and investments">
    <meta property="og:description" content="Applying data science to business and investments" />
    

    
      <meta content="http://www.mattdancho.com/Business/2016/08/07/CustomerSegmentationPt1.html" property="og:url">
    

    
      <meta content="2016-08-07T00:00:00-04:00" property="article:published_time">
      <meta content="http://www.mattdancho.com/about/" property="article:author">
    

    
      <meta content="http://www.mattdancho.com/assets/custSegments1.png" property="og:image">
    

    
      
      <meta content="Business" property="article:section">
      
    

    
      
      <meta content="R-Project" property="article:tag">
      
      <meta content="R" property="article:tag">
      
      <meta content="Customer Segmentation" property="article:tag">
      
      <meta content="Community Detection" property="article:tag">
      
      <meta content="kmeans" property="article:tag">
      
      <meta content="silhouette" property="article:tag">
      
      <meta content="bikes data set" property="article:tag">
      
    

<!-- Twitter Card -->

  <!-- <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@site_username">
  <meta name="twitter:creator" content="@creator_username">
  
    <meta name="twitter:title" content="Post">
  
  
    <meta name="twitter:url" content="http://www.mattdancho.com/Business/2016/08/07/CustomerSegmentationPt1.html">
  
  
    <meta name="twitter:description" content="Applying data science to business and investments">
  
  
    <meta name="twitter:image:src" content="http://www.mattdancho.com/img/custSegments1.png">
   -->

    <link rel="alternate" type="application/atom+xml" title="mattdancho.com" href="/atom.xml" />

<link rel="alternate" type="application/rss+xml" title="mattdancho.com" href="/feed.xml" />




    <!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>

        <link rel="icon" type="image/x-icon" href="/img/favicon.ico" />

    <!-- Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link href="/css/bootstrap.min-flatly.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/css/freelancer.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/table.css" rel="stylesheet">

    <!-- Highlightjs -->
    <link rel="stylesheet" href="/css/github.css">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Greensock -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/TweenMax.min.js"></script>

    <!-- Scrollmagic -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/debug.addIndicators.min.js"></script>



</head>

<body id="page-top" class="index">

	

	<!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Business Science</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

                <!-- Nav Links: Maintained in data/nav.csv -->
                <ul class="nav navbar-nav navbar-right">
    				

                    <!-- Search site using Google's index -->
                    <li>
                        <form class="navbar-form navbar-right" role="search" method="get" action="http://google.com/search">
                          <div class="row">
                              <div class="col-xs-8">
                                  <div class="form-group" id="inline">
                                    <input type="hidden" name="q" value="site:mattdancho.com" />
                                    <input type="text" class="form-control search-query" name="q" placeholder="Search"/>
                                  </div>
                              </div>
                              <div class="col-xs-2">
                                  <button type="submit" class="btn btn-default"><i class="fa fa-search fa-lg"></i></button>
                              </div>
                          </div>
                        </form>
                    </li>
				</ul>

            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>


	<!-- Blog Head -->
<header id="header" class="">
	<section class="success" id="blog">
		<div class= "container">
			<div class="row">
			  	<div class="col-lg-12 text-center">
			  		<div class="text-center">
					    <h1>Post</h1>
					    <p>Written on August  7, 2016</p>
					    <p>

<div class="post-tags">
  Categories:
  
    
  
  
  <li>
  	<a href="/categories/#Business">Business</a>
  </li>

  
</div></p>
					    <p>

<div class="post-tags">
  Tags:
  
    
  
  
  <li>
  	<a href="/tags/#R-Project">R-Project</a>,
  </li>

  
  <li>
  	<a href="/tags/#R">R</a>,
  </li>

  
  <li>
  	<a href="/tags/#Customer Segmentation">Customer Segmentation</a>,
  </li>

  
  <li>
  	<a href="/tags/#Community Detection">Community Detection</a>,
  </li>

  
  <li>
  	<a href="/tags/#kmeans">kmeans</a>,
  </li>

  
  <li>
  	<a href="/tags/#silhouette">silhouette</a>,
  </li>

  
  <li>
  	<a href="/tags/#bikes data set">bikes data set</a>
  </li>

  
</div></p>

					    <ul class="list-inline">
					    	<!-- Facebook -->
                            <li>
                                <div class="fb-share-button" data-href="http://www.mattdancho.com/Business/2016/08/07/CustomerSegmentationPt1.html" data-layout="box_count" data-size="small" data-mobile-iframe="true" style="bottom: 5px;"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&amp;src=sdkpreparse">Share</a></div>
                            </li>
                            <!-- LinkedIn -->
                            <li>
                                <script type="text/javascript" src="//platform.linkedin.com/in.js"></script><script type="in/share" data-counter="top"></script>
                            </li>
                            <!-- Google+ -->
                            <li>
                                <div class="g-plus" data-action="share" data-annotation="vertical-bubble" data-height="60"></div>
                            </li>
                    		<!-- Twitter -->
                            <li>
                                <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
                            </li>
                        </ul>
					</div>
			  	</div>
			</div>
		</div>
	</section>
</header>

<!-- Blog Body -->
<section id="blog">

  <div class="container" id="blog_content">
    <!-- <div class="col-md-8 col-md-offset-2"> -->
    <div class="row">
    	<!-- Main Content -->
    	<div class="col-md-8 col-md-offset-1" role="main">
	  		<p><img class="shadow" src="/assets/custSegments1.png" style="margin-top: 0px;"></p>
	  		<hr class="margin-bottom-40">
	    	<p>In this post, we’ll be using <a href="https://en.wikipedia.org/wiki/K-means_clustering"><em>k</em>-means clustering</a> in <code>R</code> to segment customers into distinct groups based on purchasing habits. <em>k</em>-means clustering is an unsupervised learning technique, which means we don’t need to have a target for clustering. All we need is to format the data in a way the algorithm can process, and we’ll let it determine the customer segments or clusters. This makes <em>k</em>-means clustering great for exploratory analysis as well as a jumping-off point for more detailed analysis. We’ll walk through a relevant example using the Cannondale <code>bikes data set</code> from the <code>orderSimulatoR</code> project <a href="https://github.com/mdancho84/orderSimulatoR">GitHub repository</a>.</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#how-works">How <em>k</em>-Means Works</a></li>
  <li><a href="#getting-started">Getting Started</a></li>
  <li><a href="#hypothesis">Developing a Hypothesis for Customer Trends</a></li>
  <li><a href="#manipulating-data">Manipulating the Data Frame</a></li>
  <li><a href="#kmeans"><em>k</em>-Means Clustering</a>
    <ul>
      <li><a href="#running-algorithm">Running the <em>k</em>-Means Algorithm</a></li>
      <li><a href="#customer-segments">Which Customers are in Each Segment?</a></li>
      <li><a href="#determine-prefs">Determining the Preferences of the Customer Segments</a></li>
      <li><a href="#review">Reviewing Results</a></li>
    </ul>
  </li>
  <li><a href="#recap">Recap</a></li>
  <li><a href="#further-reading">Further Reading</a></li>
  <li><a href="#updates">Updates</a></li>
</ul>

<h2 id="how-k-means-works-a-classanchor-idhow-worksa">How K-Means Works <a class="anchor" id="how-works"></a></h2>

<p>The <em>k</em>-means clustering algorithm works by finding like groups based on Euclidean distance, a measure of distance or similarity. The practitioner selects <script type="math/tex">k</script> groups to cluster, and the algorithm finds the best centroids for the <script type="math/tex">k</script> groups. The practitioner can then use those groups to determine which factors group members relate. For customers, these would be their buying preferences. </p>

<h2 id="getting-started-a-classanchor-idgetting-starteda">Getting Started <a class="anchor" id="getting-started"></a></h2>

<p>To start, we’ll get need some orders to evaluate. If you’d like to follow along, we will be using the <code>bikes data set</code>, which can be retrieved <a href="https://github.com/mdancho84/orderSimulatoR/tree/master/data">here</a>. We’ll load the data first using the  <code>xlsx</code> package for reading Excel files.</p>

<div>
  <pre><code class="r"># Read Cannondale orders data --------------------------------------------------
library(xlsx) 
customers &lt;- read.xlsx(&quot;./data/bikeshops.xlsx&quot;, sheetIndex = 1)
products &lt;- read.xlsx(&quot;./data/bikes.xlsx&quot;, sheetIndex = 1) 
orders &lt;- read.xlsx(&quot;./data/orders.xlsx&quot;, sheetIndex = 1)</code></pre>
</div>

<p>Next, we’ll get the data into a usable format, typical of an <code>SQL</code> query from an <a href="https://en.wikipedia.org/wiki/Enterprise_resource_planning">ERP database</a>. The following code merges the customers, products and orders data frames using the <code>dplyr</code> package.</p>

<div>
  <pre><code class="r"># Combine orders, customers, and products data frames --------------------------
library(dplyr)
orders.extended &lt;- merge(orders, customers, by.x = &quot;customer.id&quot;, by.y=&quot;bikeshop.id&quot;)
orders.extended &lt;- merge(orders.extended, products, by.x = &quot;product.id&quot;, by.y = &quot;bike.id&quot;)

orders.extended &lt;- orders.extended %&gt;%
  mutate(price.extended = price * quantity) %&gt;%
  select(order.date, order.id, order.line, bikeshop.name, model,
         quantity, price, price.extended, category1, category2, frame) %&gt;%
  arrange(order.id, order.line)

knitr::kable(head(orders.extended)) # Preview the data</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: left">order.date</th>
      <th style="text-align: right">order.id</th>
      <th style="text-align: right">order.line</th>
      <th style="text-align: left">bikeshop.name</th>
      <th style="text-align: left">model</th>
      <th style="text-align: right">quantity</th>
      <th style="text-align: right">price</th>
      <th style="text-align: right">price.extended</th>
      <th style="text-align: left">category1</th>
      <th style="text-align: left">category2</th>
      <th style="text-align: left">frame</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">2011-01-07</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Ithaca Mountain Climbers</td>
      <td style="text-align: left">Jekyll Carbon 2</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">6070</td>
      <td style="text-align: right">6070</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
    </tr>
    <tr>
      <td style="text-align: left">2011-01-07</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">Ithaca Mountain Climbers</td>
      <td style="text-align: left">Trigger Carbon 2</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">5970</td>
      <td style="text-align: right">5970</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
    </tr>
    <tr>
      <td style="text-align: left">2011-01-10</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Kansas City 29ers</td>
      <td style="text-align: left">Beast of the East 1</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">2770</td>
      <td style="text-align: right">2770</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Aluminum</td>
    </tr>
    <tr>
      <td style="text-align: left">2011-01-10</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">Kansas City 29ers</td>
      <td style="text-align: left">Trigger Carbon 2</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">5970</td>
      <td style="text-align: right">5970</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
    </tr>
    <tr>
      <td style="text-align: left">2011-01-10</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Louisville Race Equipment</td>
      <td style="text-align: left">Supersix Evo Hi-Mod Team</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">10660</td>
      <td style="text-align: right">10660</td>
      <td style="text-align: left">Road</td>
      <td style="text-align: left">Elite Road</td>
      <td style="text-align: left">Carbon</td>
    </tr>
    <tr>
      <td style="text-align: left">2011-01-10</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">Louisville Race Equipment</td>
      <td style="text-align: left">Jekyll Carbon 4</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">3200</td>
      <td style="text-align: right">3200</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
    </tr>
  </tbody>
</table>

<h2 id="developing-a-hypothesis-for-customer-trends-a-classanchor-idhypothesisa">Developing a Hypothesis for Customer Trends <a class="anchor" id="hypothesis"></a></h2>

<p>Developing a hypothesis is necessary as the hypothesis will guide our decisions on how to formulate the data in such a way to cluster customers. For the Cannondale orders, our hypothesis is that bike shops purchase Cannondale bike models based on features such as Mountain or Road Bikes and price tier (high/premium or low/affordable). Although we will use bike model to cluster on, the bike model features (e.g. price, category, etc) will be used for assessing the preferences of the customer clusters (more on this later). </p>

<p>To start, we’ll need a unit of measure to cluster on. We can select quantity purchased or total value of purchases. We’ll select quantity purchased because total value can be skewed by the bike unit price. For example, a premium bike can be sold for 10X more than an affordable bike, which can mask the quantity buying habits.</p>

<h2 id="manipulating-the-data-frame-a-classanchor-idmanipulating-dataa">Manipulating the Data Frame <a class="anchor" id="manipulating-data"></a></h2>

<p>Next, we need a data manipulation plan of attack to implement clustering on our data. We’ll user our hypothesis to guide us. First, we’ll need to get the data frame into a format conducive to clustering bike models to customer id’s. Second, we’ll need to manipulate price into a categorical variables representing high/premium and low/affordable. Last, we’ll need to scale the bike model quantities purchased by customer so the <em>k</em>-means algorithm weights the purchases of each customer evenly. </p>

<p>We’ll tackle formatting the data frame for clustering first. We need to spread the customers by quantity of bike models purchased. </p>

<div>
  <pre><code class="r"># Group by model &amp; model features, summarize by quantity purchased -------------
library(tidyr)  # Needed for spread function
customerTrends &lt;- orders.extended %&gt;%
        group_by(bikeshop.name, model, category1, category2, frame, price) %&gt;%
        summarise(total.qty = sum(quantity)) %&gt;%
        spread(bikeshop.name, total.qty)
customerTrends[is.na(customerTrends)] &lt;- 0  # Remove NA's</code></pre>
</div>

<p>Next, we need to convert the unit price to categorical high/low variables. One way to do this is with the <code>cut2()</code> function from the <code>Hmisc</code> package. We’ll segment the price into high/low by median price. Selecting <code>g</code> = 2 divides the unit prices into two halves using the median as the split point. </p>

<div>
  <pre><code class="r"># Convert price to binary high/low category ------------------------------------
library(Hmisc)  # Needed for cut2 function
customerTrends$price &lt;- cut2(customerTrends$price, g=2)</code></pre>
</div>

<p>Last, we need to scale the quantity data. Unadjusted quantities presents a problem to the <em>k</em>-means algorithm. Some customers are larger than others meaning they purchase higher volumes. Fortunately, we can resolve this issue by converting the customer order quantities to proportion of the total bikes purchased by a customer. The <code>prop.table()</code> matrix function provides a convenient way to do this. An alternative is to use the <code>scale()</code> function, which normalizes the data. However, this is less interpretable than the proportion format.</p>

<div>
  <pre><code class="r"># Convert customer purchase quantity to percentage of total quantity -----------
customerTrends.mat &lt;- as.matrix(customerTrends[,-(1:5)])  # Drop first five columns
customerTrends.mat &lt;- prop.table(customerTrends.mat, margin = 2)  # column-wise pct
customerTrends &lt;- cbind(customerTrends[,1:5], as.data.frame(customerTrends.mat))</code></pre>
</div>

<p>The final data frame (first five rows shown below) is now ready for clustering. </p>

<div>
  <pre><code class="r"># View data post manipulation --------------------------------------------------
knitr::kable(head(customerTrends))</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: left">model</th>
      <th style="text-align: left">category1</th>
      <th style="text-align: left">category2</th>
      <th style="text-align: left">frame</th>
      <th style="text-align: left">price</th>
      <th style="text-align: right">Albuquerque Cycles</th>
      <th style="text-align: right">Ann Arbor Speed</th>
      <th style="text-align: right">Austin Cruisers</th>
      <th style="text-align: right">Cincinnati Speed</th>
      <th style="text-align: right">Columbus Race Equipment</th>
      <th style="text-align: right">Dallas Cycles</th>
      <th style="text-align: right">Denver Bike Shop</th>
      <th style="text-align: right">Detroit Cycles</th>
      <th style="text-align: right">Indianapolis Velocipedes</th>
      <th style="text-align: right">Ithaca Mountain Climbers</th>
      <th style="text-align: right">Kansas City 29ers</th>
      <th style="text-align: right">Las Vegas Cycles</th>
      <th style="text-align: right">Los Angeles Cycles</th>
      <th style="text-align: right">Louisville Race Equipment</th>
      <th style="text-align: right">Miami Race Equipment</th>
      <th style="text-align: right">Minneapolis Bike Shop</th>
      <th style="text-align: right">Nashville Cruisers</th>
      <th style="text-align: right">New Orleans Velocipedes</th>
      <th style="text-align: right">New York Cycles</th>
      <th style="text-align: right">Oklahoma City Race Equipment</th>
      <th style="text-align: right">Philadelphia Bike Shop</th>
      <th style="text-align: right">Phoenix Bi-peds</th>
      <th style="text-align: right">Pittsburgh Mountain Machines</th>
      <th style="text-align: right">Portland Bi-peds</th>
      <th style="text-align: right">Providence Bi-peds</th>
      <th style="text-align: right">San Antonio Bike Shop</th>
      <th style="text-align: right">San Francisco Cruisers</th>
      <th style="text-align: right">Seattle Race Equipment</th>
      <th style="text-align: right">Tampa 29ers</th>
      <th style="text-align: right">Wichita Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Bad Habit 1</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0174825</td>
      <td style="text-align: right">0.0066445</td>
      <td style="text-align: right">0.0081301</td>
      <td style="text-align: right">0.0051151</td>
      <td style="text-align: right">0.0101523</td>
      <td style="text-align: right">0.0128205</td>
      <td style="text-align: right">0.0117340</td>
      <td style="text-align: right">0.0099206</td>
      <td style="text-align: right">0.0062696</td>
      <td style="text-align: right">0.0181962</td>
      <td style="text-align: right">0.0181504</td>
      <td style="text-align: right">0.0016026</td>
      <td style="text-align: right">0.0062893</td>
      <td style="text-align: right">0.0075949</td>
      <td style="text-align: right">0.0042135</td>
      <td style="text-align: right">0.0182648</td>
      <td style="text-align: right">0.0086705</td>
      <td style="text-align: right">0.0184783</td>
      <td style="text-align: right">0.0074074</td>
      <td style="text-align: right">0.0129870</td>
      <td style="text-align: right">0.0244898</td>
      <td style="text-align: right">0.0112755</td>
      <td style="text-align: right">0.0159151</td>
      <td style="text-align: right">0.0108696</td>
      <td style="text-align: right">0.0092251</td>
      <td style="text-align: right">0.0215054</td>
      <td style="text-align: right">0.0026738</td>
      <td style="text-align: right">0.0156250</td>
      <td style="text-align: right">0.0194175</td>
      <td style="text-align: right">0.0059172</td>
    </tr>
    <tr>
      <td style="text-align: left">Bad Habit 2</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0069930</td>
      <td style="text-align: right">0.0099668</td>
      <td style="text-align: right">0.0040650</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0170940</td>
      <td style="text-align: right">0.0139070</td>
      <td style="text-align: right">0.0158730</td>
      <td style="text-align: right">0.0031348</td>
      <td style="text-align: right">0.0110759</td>
      <td style="text-align: right">0.0158456</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0094340</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0112360</td>
      <td style="text-align: right">0.0167428</td>
      <td style="text-align: right">0.0173410</td>
      <td style="text-align: right">0.0021739</td>
      <td style="text-align: right">0.0074074</td>
      <td style="text-align: right">0.0095238</td>
      <td style="text-align: right">0.0040816</td>
      <td style="text-align: right">0.0190275</td>
      <td style="text-align: right">0.0026525</td>
      <td style="text-align: right">0.0108696</td>
      <td style="text-align: right">0.0239852</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0026738</td>
      <td style="text-align: right">0.0078125</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0000000</td>
    </tr>
    <tr>
      <td style="text-align: left">Beast of the East 1</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0104895</td>
      <td style="text-align: right">0.0149502</td>
      <td style="text-align: right">0.0081301</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0042735</td>
      <td style="text-align: right">0.0182529</td>
      <td style="text-align: right">0.0119048</td>
      <td style="text-align: right">0.0094044</td>
      <td style="text-align: right">0.0213608</td>
      <td style="text-align: right">0.0181504</td>
      <td style="text-align: right">0.0016026</td>
      <td style="text-align: right">0.0251572</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0140449</td>
      <td style="text-align: right">0.0167428</td>
      <td style="text-align: right">0.0086705</td>
      <td style="text-align: right">0.0086957</td>
      <td style="text-align: right">0.0172840</td>
      <td style="text-align: right">0.0242424</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0126850</td>
      <td style="text-align: right">0.0053050</td>
      <td style="text-align: right">0.0108696</td>
      <td style="text-align: right">0.0092251</td>
      <td style="text-align: right">0.0053763</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0156250</td>
      <td style="text-align: right">0.0097087</td>
      <td style="text-align: right">0.0000000</td>
    </tr>
    <tr>
      <td style="text-align: left">Beast of the East 2</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0104895</td>
      <td style="text-align: right">0.0099668</td>
      <td style="text-align: right">0.0081301</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0050761</td>
      <td style="text-align: right">0.0042735</td>
      <td style="text-align: right">0.0152108</td>
      <td style="text-align: right">0.0059524</td>
      <td style="text-align: right">0.0094044</td>
      <td style="text-align: right">0.0181962</td>
      <td style="text-align: right">0.0138289</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0220126</td>
      <td style="text-align: right">0.0050633</td>
      <td style="text-align: right">0.0084270</td>
      <td style="text-align: right">0.0076104</td>
      <td style="text-align: right">0.0086705</td>
      <td style="text-align: right">0.0097826</td>
      <td style="text-align: right">0.0172840</td>
      <td style="text-align: right">0.0086580</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0232558</td>
      <td style="text-align: right">0.0106101</td>
      <td style="text-align: right">0.0155280</td>
      <td style="text-align: right">0.0147601</td>
      <td style="text-align: right">0.0107527</td>
      <td style="text-align: right">0.0026738</td>
      <td style="text-align: right">0.0234375</td>
      <td style="text-align: right">0.0291262</td>
      <td style="text-align: right">0.0019724</td>
    </tr>
    <tr>
      <td style="text-align: left">Beast of the East 3</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0034965</td>
      <td style="text-align: right">0.0033223</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0025381</td>
      <td style="text-align: right">0.0042735</td>
      <td style="text-align: right">0.0169492</td>
      <td style="text-align: right">0.0119048</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0102848</td>
      <td style="text-align: right">0.0181504</td>
      <td style="text-align: right">0.0032051</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0050633</td>
      <td style="text-align: right">0.0042135</td>
      <td style="text-align: right">0.0152207</td>
      <td style="text-align: right">0.0202312</td>
      <td style="text-align: right">0.0043478</td>
      <td style="text-align: right">0.0049383</td>
      <td style="text-align: right">0.0051948</td>
      <td style="text-align: right">0.0204082</td>
      <td style="text-align: right">0.0162086</td>
      <td style="text-align: right">0.0026525</td>
      <td style="text-align: right">0.0201863</td>
      <td style="text-align: right">0.0073801</td>
      <td style="text-align: right">0.0322581</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0078125</td>
      <td style="text-align: right">0.0097087</td>
      <td style="text-align: right">0.0000000</td>
    </tr>
    <tr>
      <td style="text-align: left">CAAD Disc Ultegra</td>
      <td style="text-align: left">Road</td>
      <td style="text-align: left">Elite Road</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0139860</td>
      <td style="text-align: right">0.0265781</td>
      <td style="text-align: right">0.0203252</td>
      <td style="text-align: right">0.0153453</td>
      <td style="text-align: right">0.0101523</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0108648</td>
      <td style="text-align: right">0.0079365</td>
      <td style="text-align: right">0.0094044</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0106598</td>
      <td style="text-align: right">0.0112179</td>
      <td style="text-align: right">0.0157233</td>
      <td style="text-align: right">0.0278481</td>
      <td style="text-align: right">0.0210674</td>
      <td style="text-align: right">0.0182648</td>
      <td style="text-align: right">0.0375723</td>
      <td style="text-align: right">0.0152174</td>
      <td style="text-align: right">0.0172840</td>
      <td style="text-align: right">0.0103896</td>
      <td style="text-align: right">0.0163265</td>
      <td style="text-align: right">0.0126850</td>
      <td style="text-align: right">0.0026525</td>
      <td style="text-align: right">0.0139752</td>
      <td style="text-align: right">0.0073801</td>
      <td style="text-align: right">0.0053763</td>
      <td style="text-align: right">0.0026738</td>
      <td style="text-align: right">0.0078125</td>
      <td style="text-align: right">0.0000000</td>
      <td style="text-align: right">0.0098619</td>
    </tr>
  </tbody>
</table>

<h2 id="k-means-clustering-a-classanchor-idkmeansa">K-Means Clustering <a class="anchor" id="kmeans"></a></h2>

<p>Now we are ready to perform <em>k</em>-means clustering to segment our customer-base. Think of clusters as groups in the customer-base. Prior to starting we will need to choose the number of customer groups, <script type="math/tex">k</script>, that are to be detected. The best way to do this is to think about the customer-base and our hypothesis. We believe that there are most likely to be at least four customer groups because of mountain bike vs road bike and premium vs affordable preferences. We also believe there could be more as some customers may not care about price but may still prefer a specific bike category. However, we’ll limit the clusters to eight as more is likely to overfit the segments.</p>

<h3 id="running-the-k-means-algorithm-a-classanchor-idrunning-algorithma">Running the K-Means Algorithm <a class="anchor" id="running-algorithm"></a></h3>

<p>The code below does the following:</p>

<ol>
  <li>
    <p><strong>Converts the <code>customerTrends</code> data frame into <code>kmeansDat.t</code>.</strong> The model and features are dropped so the customer columns are all that are left. The data frame is transposed to have the customers as rows and models as columns. The <code>kmeans()</code> function requires this format.</p>
  </li>
  <li>
    <p><strong>Performs the <code>kmeans()</code> function to cluster the customer segments.</strong> We set <code>minClust</code> = 4 and <code>maxClust</code> = 8. From our hypothesis, we expect there to be at least four and at most six groups of customers. This is because customer preference is expected to vary by price (high/low) and category1 (mountain vs bike). There may be other groupings as well. Beyond eight segments may be overfitting the segments.</p>
  </li>
  <li>
    <p><strong>Uses the <code>silhouette()</code> function to obtain silhouette widths.</strong> <a href="https://en.wikipedia.org/wiki/Silhouette_(clustering)">Silhouette</a> is a technique in clustering that validates the best cluster groups. The <code>silhouette()</code> function from the <code>cluster</code> package allows us to get the average width of silhouettes, which will be used to programmatically determine the optimal cluster size.</p>
  </li>
</ol>

<div>
  <pre><code class="r"># Running the k-means algorithm -------------------------------------------------
library(cluster) # Needed for silhouette function

kmeansDat &lt;- customerTrends[,-(1:5)]  # Extract only customer columns
kmeansDat.t &lt;- t(kmeansDat)  # Get customers in rows and products in columns

# Setup for k-means loop 
km.out &lt;- list()
sil.out &lt;- list()
x &lt;- vector()
y &lt;- vector()
minClust &lt;- 4      # Hypothesized minimum number of segments
maxClust &lt;- 8      # Hypothesized maximum number of segments

# Compute k-means clustering over various clusters, k, from minClust to maxClust
for (centr in minClust:maxClust) {
        i &lt;- centr-(minClust-1) # relevels start as 1, and increases with centr
        set.seed(11) # For reproducibility
        km.out[i] &lt;- list(kmeans(kmeansDat.t, centers = centr, nstart = 50))
        sil.out[i] &lt;- list(silhouette(km.out[[i]][[1]], dist(kmeansDat.t)))
        # Used for plotting silhouette average widths
        x[i] = centr  # value of k
        y[i] = summary(sil.out[[i]])[[4]]  # Silhouette average width
}</code></pre>
</div>

<p>Next, we plot the silhouette average widths for the choice of clusters. The best cluster is the one with the largest silhouette average width, which turns out to be 5 clusters.</p>

<div>
  <pre><code class="r"># Plot silhouette results to find best number of clusters; closer to 1 is better
library(ggplot2)
ggplot(data = data.frame(x, y), aes(x, y)) + 
  geom_point(size=3) + 
  geom_line() +
  xlab(&quot;Number of Cluster Centers&quot;) +
  ylab(&quot;Silhouette Average Width&quot;) +
  ggtitle(&quot;Silhouette Average Width as Cluster Center Varies&quot;)</code></pre>
</div>

<p><img src="/figure/source/2016-8-7-CustomerSegmentationPt1/silhouettePlot-1.png" alt="plot of chunk silhouettePlot" /></p>

<h3 id="which-customers-are-in-each-segment-a-classanchor-idcustomer-segmentsa">Which Customers are in Each Segment? <a class="anchor" id="customer-segments"></a></h3>

<p>Now that we have clustered the data, we can inspect the groups find out which customers are grouped together. The code below groups the customer names by cluster X1 through X5.</p>

<div>
  <pre><code class="r"># Get customer names that are in each segment ----------------------------------

# Get attributes of optimal k-means output
maxSilRow &lt;- which.max(y)          # Row number of max silhouette value
optimalClusters &lt;- x[maxSilRow]    # Number of clusters
km.out.best &lt;- km.out[[maxSilRow]] # k-means output of best cluster

# Create list of customer names for each cluster
clusterNames &lt;- list()
clusterList &lt;- list()
for (clustr in 1:optimalClusters) {
  clusterNames[clustr] &lt;- paste0(&quot;X&quot;, clustr)
  clusterList[clustr] &lt;- list(
    names(
        km.out.best$cluster[km.out.best$cluster == clustr]
        )
    )
}
names(clusterList) &lt;- clusterNames

print(clusterList)</code></pre>
</div>

<div>
  <pre><code class="text">## $X1
## [1] &quot;Ithaca Mountain Climbers&quot;     &quot;Pittsburgh Mountain Machines&quot;
## [3] &quot;Tampa 29ers&quot;                 
## 
## $X2
## [1] &quot;Philadelphia Bike Shop&quot; &quot;San Antonio Bike Shop&quot; 
## 
## $X3
## [1] &quot;Ann Arbor Speed&quot;              &quot;Austin Cruisers&quot;             
## [3] &quot;Indianapolis Velocipedes&quot;     &quot;Miami Race Equipment&quot;        
## [5] &quot;Nashville Cruisers&quot;           &quot;New Orleans Velocipedes&quot;     
## [7] &quot;Oklahoma City Race Equipment&quot; &quot;Seattle Race Equipment&quot;      
## 
## $X4
##  [1] &quot;Albuquerque Cycles&quot;    &quot;Dallas Cycles&quot;        
##  [3] &quot;Denver Bike Shop&quot;      &quot;Detroit Cycles&quot;       
##  [5] &quot;Kansas City 29ers&quot;     &quot;Los Angeles Cycles&quot;   
##  [7] &quot;Minneapolis Bike Shop&quot; &quot;New York Cycles&quot;      
##  [9] &quot;Phoenix Bi-peds&quot;       &quot;Portland Bi-peds&quot;     
## [11] &quot;Providence Bi-peds&quot;   
## 
## $X5
## [1] &quot;Cincinnati Speed&quot;          &quot;Columbus Race Equipment&quot;  
## [3] &quot;Las Vegas Cycles&quot;          &quot;Louisville Race Equipment&quot;
## [5] &quot;San Francisco Cruisers&quot;    &quot;Wichita Speed&quot;</code></pre>
</div>

<h3 id="determining-the-preferences-of-the-customer-segments-a-classanchor-iddetermine-prefsa">Determining the Preferences of the Customer Segments <a class="anchor" id="determine-prefs"></a></h3>

<p>The easiest way to determine the customer preferences is by inspection of factors related to the model (e.g. price point, category of bike, etc). Advanced algorithms to classify the groups can be used if there are many factors, but typically this is not necessary as the trends tend to jump out. The code below attaches the <em>k</em>-means centroids to the bike models and categories for trend inspection.</p>

<div>
  <pre><code class="r"># Combine cluster centroids with bike models for feature inspection ------------
custSegmentCntrs &lt;- t(km.out.best$centers)  # Get centroids for groups
colnames(custSegmentCntrs) &lt;- make.names(colnames(custSegmentCntrs))
customerTrends.clustered &lt;- cbind(customerTrends[,1:5], custSegmentCntrs)</code></pre>
</div>

<p>Now, on to cluster inspection.</p>

<h4 id="cluster-1">Cluster 1</h4>

<p>We’ll order by cluster 1’s top ten bike models in descending order. We can quickly see that the top 10 models purchased are predominantly high-end and mountain. The all but one model has a carbon frame. </p>

<div>
  <pre><code class="r"># Arrange top 10 bike models by cluster in descending order --------------------
attach(customerTrends.clustered)  # Allows ordering by column name
knitr::kable(head(customerTrends.clustered[order(-X1), c(1:5, 6)], 10))</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: left">model</th>
      <th style="text-align: left">category1</th>
      <th style="text-align: left">category2</th>
      <th style="text-align: left">frame</th>
      <th style="text-align: left">price</th>
      <th style="text-align: right">X1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">46</td>
      <td style="text-align: left">Scalpel-Si Carbon 3</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Cross Country Race</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[3500,12790]</td>
      <td style="text-align: right">0.0342692</td>
    </tr>
    <tr>
      <td style="text-align: left">42</td>
      <td style="text-align: left">Jekyll Carbon 4</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0302818</td>
    </tr>
    <tr>
      <td style="text-align: left">53</td>
      <td style="text-align: left">Scalpel 29 Carbon Race</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Cross Country Race</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[3500,12790]</td>
      <td style="text-align: right">0.0280391</td>
    </tr>
    <tr>
      <td style="text-align: left">96</td>
      <td style="text-align: left">Trigger Carbon 3</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[3500,12790]</td>
      <td style="text-align: right">0.0259353</td>
    </tr>
    <tr>
      <td style="text-align: left">35</td>
      <td style="text-align: left">Habit Carbon 2</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[3500,12790]</td>
      <td style="text-align: right">0.0233750</td>
    </tr>
    <tr>
      <td style="text-align: left">97</td>
      <td style="text-align: left">Trigger Carbon 4</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0232606</td>
    </tr>
    <tr>
      <td style="text-align: left">20</td>
      <td style="text-align: left">Catalyst 4</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Sport</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0215639</td>
    </tr>
    <tr>
      <td style="text-align: left">40</td>
      <td style="text-align: left">Jekyll Carbon 2</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[3500,12790]</td>
      <td style="text-align: right">0.0210792</td>
    </tr>
    <tr>
      <td style="text-align: left">62</td>
      <td style="text-align: left">Supersix Evo Hi-Mod Dura Ace 2</td>
      <td style="text-align: left">Road</td>
      <td style="text-align: left">Elite Road</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[3500,12790]</td>
      <td style="text-align: right">0.0210578</td>
    </tr>
    <tr>
      <td style="text-align: left">95</td>
      <td style="text-align: left">Trigger Carbon 2</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[3500,12790]</td>
      <td style="text-align: right">0.0210433</td>
    </tr>
  </tbody>
</table>

<h4 id="cluster-2">Cluster 2</h4>

<p>Next, we’ll inspect cluster 2. We can see that the top models are all low-end/affordable models. There’s a mix of road and mountain for the primariy category and a mix of frame material as well.</p>

<div>
  <pre><code class="r"># Arrange top 10 bike models by cluster in descending order
knitr::kable(head(customerTrends.clustered[order(-X2), c(1:5, 7)], 10))</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: left">model</th>
      <th style="text-align: left">category1</th>
      <th style="text-align: left">category2</th>
      <th style="text-align: left">frame</th>
      <th style="text-align: left">price</th>
      <th style="text-align: right">X2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">57</td>
      <td style="text-align: left">Slice Ultegra</td>
      <td style="text-align: left">Road</td>
      <td style="text-align: left">Triathalon</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0554531</td>
    </tr>
    <tr>
      <td style="text-align: left">97</td>
      <td style="text-align: left">Trigger Carbon 4</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Over Mountain</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0304147</td>
    </tr>
    <tr>
      <td style="text-align: left">7</td>
      <td style="text-align: left">CAAD12 105</td>
      <td style="text-align: left">Road</td>
      <td style="text-align: left">Elite Road</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0270792</td>
    </tr>
    <tr>
      <td style="text-align: left">5</td>
      <td style="text-align: left">Beast of the East 3</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0263331</td>
    </tr>
    <tr>
      <td style="text-align: left">89</td>
      <td style="text-align: left">Trail 1</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Sport</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0249397</td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">Bad Habit 1</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Trail</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0229976</td>
    </tr>
    <tr>
      <td style="text-align: left">26</td>
      <td style="text-align: left">F-Si Carbon 4</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Cross Country Race</td>
      <td style="text-align: left">Carbon</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0224490</td>
    </tr>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: left">CAAD12 Disc 105</td>
      <td style="text-align: left">Road</td>
      <td style="text-align: left">Elite Road</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0209568</td>
    </tr>
    <tr>
      <td style="text-align: left">81</td>
      <td style="text-align: left">Synapse Disc 105</td>
      <td style="text-align: left">Road</td>
      <td style="text-align: left">Endurance Road</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0209568</td>
    </tr>
    <tr>
      <td style="text-align: left">90</td>
      <td style="text-align: left">Trail 2</td>
      <td style="text-align: left">Mountain</td>
      <td style="text-align: left">Sport</td>
      <td style="text-align: left">Aluminum</td>
      <td style="text-align: left">[ 415, 3500)</td>
      <td style="text-align: right">0.0203094</td>
    </tr>
  </tbody>
</table>

<div>
  <pre><code class="r">detach(customerTrends.clustered)</code></pre>
</div>

<h4 id="clusters-3-4--5">Clusters 3, 4 &amp; 5</h4>

<p>Inspecting clusters 3, 4 and 5 produce interesting results. For brevity, we won’t display the tables. Here’s the results:</p>

<ul>
  <li>Cluster 3: Tends to prefer road bikes that are low-end. </li>
  <li>Cluster 4: Is very similar to Cluster 2 with the majority of bikes in the low-end price range. </li>
  <li>Cluster 5: Tends to refer road bikes that are high-end.  </li>
</ul>

<h4 id="reviewing-results-a-classanchor-idreviewa">Reviewing Results <a class="anchor" id="review"></a></h4>

<p>Once the clustering is finished, it’s a good idea to take a step back and review what the algorithm is saying. For our analysis, we got clear trends for four of five groups, but two groups (clusters 2 and 4) are very similar. Because of this, it may make sense to combine these two groups or to switch from <script type="math/tex">k</script> = 5 to <script type="math/tex">k</script> = 4 results. </p>

<h2 id="recap-a-classanchor-idrecapa">Recap <a class="anchor" id="recap"></a></h2>

<p>The customer segmentation process can be performed with various clustering algorithms. In this post, we focused on <em>k</em>-means clustering in <code>R</code>. While the algorithm is quite simple to implement, half the battle is getting the data into the correct format and interpreting the results. We went over formatting the order data, running the <code>kmeans()</code> function to cluster the data with several hypothetical <script type="math/tex">k</script> clusters, using <code>silhouette()</code> from the <code>cluster</code> package to determine the optimal number of <script type="math/tex">k</script> clusters, and interpreting the results by inspection of the <em>k</em>-means centroids. Happy clustering!</p>

<h2 id="further-reading-a-classanchor-idfurther-readinga">Further Reading <a class="anchor" id="further-reading"></a></h2>

<ol>
  <li><a href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-111866146X.html">Data Smart by John Foreman</a>: Chapter 2 covers k-medians clustering and silhouette analysis, which is very similar to the approach I use here.</li>
</ol>

<h2 id="updates-a-classanchor-idupdatesa">Updates <a class="anchor" id="updates"></a></h2>

<ol>
  <li>August 28, 2016: There was an issue with the <code>set.seed()</code> being outside of the for-loop in the <em>k</em>-means algorithm preventing the kmeans output from being completely reproducible. The <code>set.seed()</code> was moved inside the for-loop.</li>
</ol>

	    </div>
	    <!-- Sidebar -->
	    <div class="col-md-3 well well-lg bs-component hidden-print hidden-sm hidden-xs" role="complimentary">
	    	<nav class="bs-docs-sidebar ">
	<ul class="nav bs-docs-sidenav">

		<!-- Feedburer Email Signup-->
		<li>
			<!-- <h5>Interested in Business Science? Subscribe!</h5> -->
			<form style="border:1px solid #ccc;padding:3px;text-align:center;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=mattdancho', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
                <div class="row">
                    <div class="col-md-12">
                        <p style="color: #2c3e50;">Get <em>Business Science</em> updates:</p>
                        <p><input type="text" style="width:90%; color: #2c3e50; padding-left: 4px;" name="email" placeholder="email address" /></p>
                        <input type="hidden" value="mattdancho" name="uri"/>
                        <input type="hidden" name="loc" value="en_US"/>
                    </div>

                    <div class="col-sm-12 col-md-6">
                        <input type="submit" value="Subscribe" class="btn btn-primary btn-sm" style="margin-bottom: 8px;"/>
                    </div>
                    <div class="col-sm-12 col-md-6">
                        <p class="text-center"><a href="http://feeds.feedburner.com/mattdancho"><img src="http://feeds.feedburner.com/~fc/mattdancho?bg=99CCFF&amp;fg=444444&amp;anim=0" height="26" width="75%" style="border:0" alt="" /></a></p>
                    </div>
                </div>
            </form>
		</li>
		<li><hr></li>

		<!-- Post Navigation -->
		
		<li>
			<ul class="pager">
			  
			    <li class="previous">
			    	<a href="/Business/2016/07/12/orderSimulatoR.html"><i class="fa fa-arrow-circle-left"></i> Prev</a>
			    </li>
			  
			  
			    <li class="next">
			    	<a class="" href="/Business/2016/09/04/CustomerSegmentationPt2.html">Next <i class="fa fa-arrow-circle-right"></i></a>
			    </li>
			  
			</ul>
		</li>
		<li><hr></li>
		

		<!-- Blog Navigation -->
		

		<!-- Recent Posts -->
		<li>
			<h5>Recent Posts</h5>
			<div class="list-group">
				
				<a href="/Business/2016/10/01/CustomerSegmentationPt3.html" class="list-group-item">
					<h6 class="list-group-item-heading">Customer Segmentation Part 3: Network Visualization</h6>
				    
	                  <img src="/assets/custSegments3.png" alt="..." style="width: 100%;">
	                
				</a>
				
				<a href="/Business/2016/09/04/CustomerSegmentationPt2.html" class="list-group-item">
					<h6 class="list-group-item-heading">Customer Segmentation Part 2: PCA for Segment Visualization</h6>
				    
	                  <img src="/assets/custSegments2.png" alt="..." style="width: 100%;">
	                
				</a>
				
				<a href="/Business/2016/08/07/CustomerSegmentationPt1.html" class="list-group-item">
					<h6 class="list-group-item-heading">Customer Segmentation Part 1: K-Means Clustering</h6>
				    
	                  <img src="/assets/custSegments1.png" alt="..." style="width: 100%;">
	                
				</a>
				
			</div>
		</li>
		<li><hr></li>

		<!-- Categories -->
		<li>
			<h5>Categories</h5>
			
			<div class = "button-margin">
				<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#Technology" aria-expanded="false" aria-controls="R">
				  Technology:
				  <span class="badge">1</span>
				</button>
				<div class="collapse" id="Technology">
				  <div class="list-group">
				    
				      
				      	
				      
				    
				      
				      	
					        <!-- <a href="/Technology/2016/04/09/A-Data-Scientists-Resources.html" class="list-group-item">A Data Scientist's Resources</a> -->
					        <a href="/Technology/2016/04/09/A-Data-Scientists-Resources.html" class="list-group-item">
								<h6 class="list-group-item-heading">A Data Scientist's Resources</h6>
							    
				                  <img src="/assets/sextant.jpg" alt="..." style="width: 100%;">
				                
							</a>
					    
				      
				    
				  </div>
				</div>
			</div>
			
			<div class = "button-margin">
				<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#Business" aria-expanded="false" aria-controls="R">
				  Business:
				  <span class="badge">1</span>
				</button>
				<div class="collapse" id="Business">
				  <div class="list-group">
				    
				      
				      	
				      
				    
				      
				      	
					        <!-- <a href="/Business/2016/05/01/Marketing-Strategy-MBAs-Learn-Analytics.html" class="list-group-item">Marketing Strategy: Why MBAs Can Benefit from Learning Analytics</a> -->
					        <a href="/Business/2016/05/01/Marketing-Strategy-MBAs-Learn-Analytics.html" class="list-group-item">
								<h6 class="list-group-item-heading">Marketing Strategy: Why MBAs Can Benefit from Learning Analytics</h6>
							    
				                  <img src="/assets/digital_woman.jpg" alt="..." style="width: 100%;">
				                
							</a>
					    
				      
				    
				  </div>
				</div>
			</div>
			
			<div class = "button-margin">
				<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#Business" aria-expanded="false" aria-controls="R">
				  Business:
				  <span class="badge">4</span>
				</button>
				<div class="collapse" id="Business">
				  <div class="list-group">
				    
				      
				      	
				      
				    
				      
				      	
					        <!-- <a href="/Business/2016/10/01/CustomerSegmentationPt3.html" class="list-group-item">Customer Segmentation Part 3: Network Visualization</a> -->
					        <a href="/Business/2016/10/01/CustomerSegmentationPt3.html" class="list-group-item">
								<h6 class="list-group-item-heading">Customer Segmentation Part 3: Network Visualization</h6>
							    
				                  <img src="/assets/custSegments3.png" alt="..." style="width: 100%;">
				                
							</a>
					    
				      
				      	
					        <!-- <a href="/Business/2016/09/04/CustomerSegmentationPt2.html" class="list-group-item">Customer Segmentation Part 2: PCA for Segment Visualization</a> -->
					        <a href="/Business/2016/09/04/CustomerSegmentationPt2.html" class="list-group-item">
								<h6 class="list-group-item-heading">Customer Segmentation Part 2: PCA for Segment Visualization</h6>
							    
				                  <img src="/assets/custSegments2.png" alt="..." style="width: 100%;">
				                
							</a>
					    
				      
				      	
					        <!-- <a href="/Business/2016/08/07/CustomerSegmentationPt1.html" class="list-group-item">Customer Segmentation Part 1: K-Means Clustering</a> -->
					        <a href="/Business/2016/08/07/CustomerSegmentationPt1.html" class="list-group-item">
								<h6 class="list-group-item-heading">Customer Segmentation Part 1: K-Means Clustering</h6>
							    
				                  <img src="/assets/custSegments1.png" alt="..." style="width: 100%;">
				                
							</a>
					    
				      
				      	
					        <!-- <a href="/Business/2016/07/12/orderSimulatoR.html" class="list-group-item">orderSimulatoR: Simulate Orders for Business Analytics</a> -->
					        <a href="/Business/2016/07/12/orderSimulatoR.html" class="list-group-item">
								<h6 class="list-group-item-heading">orderSimulatoR: Simulate Orders for Business Analytics</h6>
							    
				                  <img src="/assets/cannondale_bike.jpg" alt="..." style="width: 100%;">
				                
							</a>
					    
				      
				    
				  </div>
				</div>
			</div>
			
		</li>
		<li><hr></li>

		<!-- Tags -->
		<li>
			<h5>Tags</h5>
			<div>
				<!-- https://blog.lanyonm.org/articles/2013/11/21/alphabetize-jekyll-page-tags-pure-liquid.html -->
				
				

				
				
				<a href="/tags/#BI" class="btn btn-primary btn-xs">BI: <span class="badge">1</span></a>
				
				
				<a href="/tags/#CRM" class="btn btn-primary btn-xs">CRM: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Code" class="btn btn-primary btn-xs">Code: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Community Detection" class="btn btn-primary btn-xs">Community Detection: <span class="badge">3</span></a>
				
				
				<a href="/tags/#Customer Segmentation" class="btn btn-primary btn-xs">Customer Segmentation: <span class="badge">3</span></a>
				
				
				<a href="/tags/#Data Mining" class="btn btn-primary btn-xs">Data Mining: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Excel" class="btn btn-primary btn-xs">Excel: <span class="badge">1</span></a>
				
				
				<a href="/tags/#MBA" class="btn btn-primary btn-xs">MBA: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Marketing" class="btn btn-primary btn-xs">Marketing: <span class="badge">1</span></a>
				
				
				<a href="/tags/#PCA" class="btn btn-primary btn-xs">PCA: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Python" class="btn btn-primary btn-xs">Python: <span class="badge">1</span></a>
				
				
				<a href="/tags/#R" class="btn btn-primary btn-xs">R: <span class="badge">5</span></a>
				
				
				<a href="/tags/#R-Project" class="btn btn-primary btn-xs">R-Project: <span class="badge">4</span></a>
				
				
				<a href="/tags/#SQL" class="btn btn-primary btn-xs">SQL: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Sales Data Scientist" class="btn btn-primary btn-xs">Sales Data Scientist: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Salesforce" class="btn btn-primary btn-xs">Salesforce: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Simulation" class="btn btn-primary btn-xs">Simulation: <span class="badge">1</span></a>
				
				
				<a href="/tags/#Strategy" class="btn btn-primary btn-xs">Strategy: <span class="badge">1</span></a>
				
				
				<a href="/tags/#bikes data set" class="btn btn-primary btn-xs">bikes data set: <span class="badge">4</span></a>
				
				
				<a href="/tags/#igraph" class="btn btn-primary btn-xs">igraph: <span class="badge">1</span></a>
				
				
				<a href="/tags/#kmeans" class="btn btn-primary btn-xs">kmeans: <span class="badge">1</span></a>
				
				
				<a href="/tags/#networkD3" class="btn btn-primary btn-xs">networkD3: <span class="badge">1</span></a>
				
				
				<a href="/tags/#orderSimulatoR" class="btn btn-primary btn-xs">orderSimulatoR: <span class="badge">1</span></a>
				
				
				<a href="/tags/#prcomp" class="btn btn-primary btn-xs">prcomp: <span class="badge">1</span></a>
				
				
				<a href="/tags/#silhouette" class="btn btn-primary btn-xs">silhouette: <span class="badge">1</span></a>
				
			</div>

		</li>
		<li><hr></li>

		<!-- Resources -->
		<li>
			<h5>Resources</h5>
			<!-- R -->
			<div class = "button-margin">
				<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#R" aria-expanded="false" aria-controls="R">
				  R: <span class="badge">0</span>
				</button>
				<div class="collapse" id="R">
				  <div class="list-group">
				    
				  </div>
				</div>
			</div>

			<!-- Python -->
			<div class = "button-margin">
				<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#Python" aria-expanded="false" aria-controls="Python">
				  Python: <span class="badge">0</span>
				</button>
				<div class="collapse" id="Python">
				  <div class="list-group">
				    
				  </div>
				</div>
			</div>

			<!-- Power BI -->
			<div class = "button-margin">
				<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#PowerBI" aria-expanded="false" aria-controls="PowerBI">
				  Power BI: <span class="badge">0</span>
				</button>
				<div class="collapse" id="PowerBI">
				  <div class="list-group">
				    
				  </div>
				</div>
			</div>

			<!-- Tableau -->
			<div class = "button-margin">
				<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#Tableau" aria-expanded="false" aria-controls="Tableau">
				  Tableau: <span class="badge">0</span>
				</button>
				<div class="collapse" id="Tableau">
				  <div class="list-group">
				    
				  </div>
				</div>
			</div>

			<!-- Excel -->
			<div class = "button-margin">
				<button class="btn btn-primary" style="width: 100%;" type="button" data-toggle="collapse" data-target="#Excel" aria-expanded="false" aria-controls="Excel">
				  Excel <span class="badge">0</span>
				</button>
				<div class="collapse" id="Excel">
				  <div class="list-group">
					
				  </div>
				</div>
			</div>

		</li>
		<!-- <li><hr></li> -->


	</ul>
</nav>
	    </div>
    </div>


  </div>

  <div class="container">
  	<div class="col-md-8 col-md-offset-1">
		<div class="PageNavigation">
		  
		    <a class="prev" href="/Business/2016/07/12/orderSimulatoR.html">
		    	<i class="fa fa-arrow-circle-left"></i>
		    	orderSimulatoR: Simulate Orders for Business Analytics
		    </a>
		  
		  
		    <a class="next pull-right" href="/Business/2016/09/04/CustomerSegmentationPt2.html">
		    	Customer Segmentation Part 2: PCA for Segment Visualization
				<i class="fa fa-arrow-circle-right"></i>
		    </a>
		  
		</div>
	</div>
	 </div>
</section>

<!-- Disqus -->
<div class="container">
	<div class="col-md-8 col-md-offset-1">
	Include file 'disqus.html disqus_identifier=page.disqus_identifier' contains invalid characters or sequences
	</div>
</div>


<!-- htmlwidgets dependencies -->
<!--  -->


	<!-- Footer -->
    <footer class="text-center">
        <div class="footer-above">
            <div class="container">
                <div class="row">

                    <div class="footer-col col-md-4">
                        <h3 class="footer">About the Site</h3>
                        <p>This site is dedicated to using data science and analytics in a variety of business and investment settings to gain insights beyond face-value. <a href="/about.html">Learn more</a>.</p>
                    </div>

                    <div class="footer-col col-md-4">
                        <h3 class="footer">Around the Web</h3>
                        <ul class="list-inline">
                            <li>
                                <a href="http://www.mattdancho.com/atom.xml" class="btn-social btn-outline"><i class="fa fa-fw fa-rss"></i></a>
                            </li>
                            <li>
                                <a href="mailto:mdancho@gmail.com" class="btn-social btn-outline"><i class="fa fa-fw fa-envelope"></i></a>
                            </li>
                            <li>
                                <a href="https://github.com/mdancho84" class="btn-social btn-outline"><i class="fa fa-fw fa-github"></i></a>
                            </li>
                            <li>
                                <a href="https://www.linkedin.com/in/mattdancho" class="btn-social btn-outline"><i class="fa fa-fw fa-linkedin"></i></a>
                            </li>
                        </ul>
                    </div>

                    <div class="footer-col col-md-4">
                        <!-- <h3 class="footer">Location</h3>
                        <p>State College, PA</p> -->
                        <h3 class="footer">Interested?</h3>
                        <div class="well">
                            <form style="border:1px solid #ccc;padding:3px;text-align:center;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=mattdancho', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
                                <div class="row">
                                    <div class="col-md-12">
                                        <p style="color: #2c3e50;">Get <em>Business Science</em> updates:</p>
                                        <p><input type="text" style="width:90%; color: #2c3e50; padding-left: 4px;" name="email" placeholder="email address" /></p>
                                        <input type="hidden" value="mattdancho" name="uri"/>
                                        <input type="hidden" name="loc" value="en_US"/>
                                    </div>

                                    <div class="col-sm-12 col-md-6">
                                        <input type="submit" value="Subscribe" class="btn btn-primary btn-sm" style="margin-bottom: 8px;"/>
                                    </div>
                                    <div class="col-sm-12 col-md-6">
                                        <p class="text-center"><a href="http://feeds.feedburner.com/mattdancho"><img src="http://feeds.feedburner.com/~fc/mattdancho?bg=99CCFF&amp;fg=444444&amp;anim=0" height="26" width="88" style="border:0" alt="" /></a></p>
                                    </div>
                                </div>
                            </form>
                        </div>

                    </div>

                </div>
            </div>
        </div>
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; www.mattdancho.com 2016
                    </div>
                </div>
            </div>
        </div>
    </footer>

	<!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-top page-scroll" id="top-link-block">
            <a class="btn btn-primary" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

    <!-- jQuery -->
    <script src="/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="/js/classie.js"></script>
    <script src="/js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="/js/jqBootstrapValidation.js"></script>
    <!-- <script src="/js/contact_me.js"></script> -->

    <!-- MathJax processing for LaTeX -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

    <!-- Highlightjs -->
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Custom Theme JavaScript -->
    <script src="/js/freelancer.js"></script>
    <script src="/js/scripts.js"></script>

    <!-- Google+ -->
    <script src="https://apis.google.com/js/platform.js" async defer></script>

    <!-- Facebook -->
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.7";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>


    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-76139189-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/Business/2016/08/07/CustomerSegmentationPt1.html',
		  'title': 'Post'
		});
	</script>
	<!-- End Google Analytics -->



</body>

</html>
